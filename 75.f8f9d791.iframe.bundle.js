"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[75],{"../node_modules/.pnpm/@lexical+react@0.15.0_react-dom@18.3.1_react@18.3.1_yjs@13.6.15/node_modules/@lexical/react/LexicalNestedComposer.prod.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s:()=>f});var _lexical_react_LexicalCollaborationContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/.pnpm/@lexical+react@0.15.0_react-dom@18.3.1_react@18.3.1_yjs@13.6.15/node_modules/@lexical/react/LexicalCollaborationContext.prod.mjs"),_lexical_react_LexicalComposerContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/.pnpm/@lexical+react@0.15.0_react-dom@18.3.1_react@18.3.1_yjs@13.6.15/node_modules/@lexical/react/LexicalComposerContext.prod.mjs"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");var c=function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}((function(e){const t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}));function p(e){const t=e.transform();return null!==t?new Set([t]):new Set}function f({initialEditor:s,children:f,initialNodes:d,initialTheme:u,skipCollabChecks:m}){const h=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(!1),x=(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_lexical_react_LexicalComposerContext__WEBPACK_IMPORTED_MODULE_1__.Gu);null==x&&c(9);const[_,{getTheme:g}]=x,v=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>{const e=u||g()||void 0,t=(0,_lexical_react_LexicalComposerContext__WEBPACK_IMPORTED_MODULE_1__.Mx)(x,e);if(void 0!==e&&(s._config.theme=e),s._parentEditor=_,d)for(let e of d){let t=null,r=null;if("function"!=typeof e){const o=e;e=o.replace,t=o.with,r=o.withKlass||null}const o=s._nodes.get(e.getType());s._nodes.set(e.getType(),{exportDOM:o?o.exportDOM:void 0,klass:e,replace:t,replaceWithKlass:r,transforms:p(e)})}else{const e=s._nodes=new Map(_._nodes);for(const[t,r]of e)s._nodes.set(t,{exportDOM:r.exportDOM,klass:r.klass,replace:r.replace,replaceWithKlass:r.replaceWithKlass,transforms:p(r.klass)})}return s._config.namespace=_._config.namespace,s._editable=_._editable,[s,t]}),[]),{isCollabActive:w,yjsDocMap:b}=(0,_lexical_react_LexicalCollaborationContext__WEBPACK_IMPORTED_MODULE_2__.k)(),M=m||h.current||b.has(s.getKey());return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{M&&(h.current=!0)}),[M]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>_.registerEditableListener((e=>{s.setEditable(e)}))),[s,_]),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_lexical_react_LexicalComposerContext__WEBPACK_IMPORTED_MODULE_1__.Gu.Provider,{value:v},!w||M?f:null)}},"./nodes/InlineImageComponent.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{UpdateInlineImageDialog:()=>UpdateInlineImageDialog,default:()=>InlineImageComponent});var _lexical_react_LexicalAutoFocusPlugin__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("../node_modules/.pnpm/@lexical+react@0.15.0_react-dom@18.3.1_react@18.3.1_yjs@13.6.15/node_modules/@lexical/react/LexicalAutoFocusPlugin.prod.mjs"),_lexical_react_LexicalComposerContext__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("../node_modules/.pnpm/@lexical+react@0.15.0_react-dom@18.3.1_react@18.3.1_yjs@13.6.15/node_modules/@lexical/react/LexicalComposerContext.prod.mjs"),_lexical_react_LexicalErrorBoundary__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("../node_modules/.pnpm/@lexical+react@0.15.0_react-dom@18.3.1_react@18.3.1_yjs@13.6.15/node_modules/@lexical/react/LexicalErrorBoundary.prod.mjs"),_lexical_react_LexicalNestedComposer__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("../node_modules/.pnpm/@lexical+react@0.15.0_react-dom@18.3.1_react@18.3.1_yjs@13.6.15/node_modules/@lexical/react/LexicalNestedComposer.prod.mjs"),_lexical_react_LexicalRichTextPlugin__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("../node_modules/.pnpm/@lexical+react@0.15.0_react-dom@18.3.1_react@18.3.1_yjs@13.6.15/node_modules/@lexical/react/LexicalRichTextPlugin.prod.mjs"),_lexical_react_useLexicalNodeSelection__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../node_modules/.pnpm/@lexical+react@0.15.0_react-dom@18.3.1_react@18.3.1_yjs@13.6.15/node_modules/@lexical/react/useLexicalNodeSelection.prod.mjs"),_lexical_utils__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("../node_modules/.pnpm/@lexical+utils@0.15.0/node_modules/@lexical/utils/LexicalUtils.prod.mjs"),lexical__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../node_modules/.pnpm/lexical@0.15.0/node_modules/lexical/Lexical.prod.mjs"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/.pnpm/react@18.3.1/node_modules/react/index.js"),_hooks_useModal__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./hooks/useModal.tsx"),_plugins_LinkPlugin__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./plugins/LinkPlugin/index.tsx"),_ui_Button__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ui/Button.tsx"),_ui_ContentEditable__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ui/ContentEditable.tsx"),_ui_Dialog__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ui/Dialog.tsx"),_ui_Placeholder__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ui/Placeholder.tsx"),_ui_Select__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ui/Select.tsx"),_ui_TextInput__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ui/TextInput.tsx"),_InlineImageNode__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./nodes/InlineImageNode.tsx");__webpack_require__("./nodes/InlineImageNode.css");const imageCache=new Set;function LazyImage(_ref){let{className,altText,height,imageRef,position,src,width}=_ref;return function useSuspenseImage(src){if(!imageCache.has(src))throw new Promise((resolve=>{const img=new Image;img.src=src,img.onload=()=>{imageCache.add(src),resolve(null)}}))}(src),react__WEBPACK_IMPORTED_MODULE_0__.createElement("img",{style:{display:"block",height,width},alt:altText,className:className||void 0,"data-position":position,draggable:"false",ref:imageRef,src})}function UpdateInlineImageDialog(_ref2){let{activeEditor,nodeKey,onClose}=_ref2;const node=activeEditor.getEditorState().read((()=>(0,lexical__WEBPACK_IMPORTED_MODULE_11__.ns)(nodeKey))),[altText,setAltText]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(node.getAltText()),[showCaption,setShowCaption]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(node.getShowCaption()),[position,setPosition]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(node.getPosition());return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{marginBottom:"1em"}},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_TextInput__WEBPACK_IMPORTED_MODULE_8__.A,{"data-test-id":"image-modal-alt-text-input",label:"Alt Text",onChange:setAltText,placeholder:"Descriptive alternative text",value:altText})),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Select__WEBPACK_IMPORTED_MODULE_7__.A,{id:"position-select",label:"Position",name:"position",onChange:e=>{setPosition(e.target.value)},style:{marginBottom:"1em",width:"208px"},value:position},react__WEBPACK_IMPORTED_MODULE_0__.createElement("option",{value:"left"},"Left"),react__WEBPACK_IMPORTED_MODULE_0__.createElement("option",{value:"right"},"Right"),react__WEBPACK_IMPORTED_MODULE_0__.createElement("option",{value:"full"},"Full Width")),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"Input__wrapper"},react__WEBPACK_IMPORTED_MODULE_0__.createElement("input",{checked:showCaption,id:"caption",onChange:e=>{setShowCaption(e.target.checked)},type:"checkbox"}),react__WEBPACK_IMPORTED_MODULE_0__.createElement("label",{htmlFor:"caption"},"Show Caption")),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Dialog__WEBPACK_IMPORTED_MODULE_5__.i,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Button__WEBPACK_IMPORTED_MODULE_3__.$,{"data-test-id":"image-modal-file-upload-btn",onClick:()=>(()=>{const payload={altText,position,showCaption};node&&activeEditor.update((()=>{node.update(payload)})),onClose()})()},"Confirm")))}function InlineImageComponent(_ref3){let{altText,caption,height,nodeKey,position,showCaption,src,width}=_ref3;const[modal,showModal]=(0,_hooks_useModal__WEBPACK_IMPORTED_MODULE_1__.A)(),imageRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),buttonRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),[isSelected,setSelected,clearSelection]=(0,_lexical_react_useLexicalNodeSelection__WEBPACK_IMPORTED_MODULE_12__.Y)(nodeKey),[editor]=(0,_lexical_react_LexicalComposerContext__WEBPACK_IMPORTED_MODULE_13__.DF)(),[selection,setSelection]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),activeEditorRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),$onDelete=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((payload=>{if(isSelected&&(0,lexical__WEBPACK_IMPORTED_MODULE_11__.RT)((0,lexical__WEBPACK_IMPORTED_MODULE_11__.vJ)())){payload.preventDefault();const node=(0,lexical__WEBPACK_IMPORTED_MODULE_11__.ns)(nodeKey);if((0,_InlineImageNode__WEBPACK_IMPORTED_MODULE_9__.zq)(node))return node.remove(),!0}return!1}),[isSelected,nodeKey]),$onEnter=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((event=>{const latestSelection=(0,lexical__WEBPACK_IMPORTED_MODULE_11__.vJ)(),buttonElem=buttonRef.current;if(isSelected&&(0,lexical__WEBPACK_IMPORTED_MODULE_11__.RT)(latestSelection)&&1===latestSelection.getNodes().length){if(showCaption)return(0,lexical__WEBPACK_IMPORTED_MODULE_11__.n1)(null),event.preventDefault(),caption.focus(),!0;if(null!==buttonElem&&buttonElem!==document.activeElement)return event.preventDefault(),buttonElem.focus(),!0}return!1}),[caption,isSelected,showCaption]),$onEscape=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((event=>(activeEditorRef.current===caption||buttonRef.current===event.target)&&((0,lexical__WEBPACK_IMPORTED_MODULE_11__.n1)(null),editor.update((()=>{setSelected(!0);const parentRootElement=editor.getRootElement();null!==parentRootElement&&parentRootElement.focus()})),!0)),[caption,editor,setSelected]);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{let isMounted=!0;const unregister=(0,_lexical_utils__WEBPACK_IMPORTED_MODULE_14__.Sd)(editor.registerUpdateListener((_ref4=>{let{editorState}=_ref4;isMounted&&setSelection(editorState.read((()=>(0,lexical__WEBPACK_IMPORTED_MODULE_11__.vJ)())))})),editor.registerCommand(lexical__WEBPACK_IMPORTED_MODULE_11__.Mv,((_,activeEditor)=>(activeEditorRef.current=activeEditor,!1)),lexical__WEBPACK_IMPORTED_MODULE_11__.Ac),editor.registerCommand(lexical__WEBPACK_IMPORTED_MODULE_11__.d8,(payload=>{const event=payload;return event.target===imageRef.current&&(event.shiftKey?setSelected(!isSelected):(clearSelection(),setSelected(!0)),!0)}),lexical__WEBPACK_IMPORTED_MODULE_11__.Ac),editor.registerCommand(lexical__WEBPACK_IMPORTED_MODULE_11__.Tg,(event=>event.target===imageRef.current&&(event.preventDefault(),!0)),lexical__WEBPACK_IMPORTED_MODULE_11__.Ac),editor.registerCommand(lexical__WEBPACK_IMPORTED_MODULE_11__.w$,$onDelete,lexical__WEBPACK_IMPORTED_MODULE_11__.Ac),editor.registerCommand(lexical__WEBPACK_IMPORTED_MODULE_11__.gC,$onDelete,lexical__WEBPACK_IMPORTED_MODULE_11__.Ac),editor.registerCommand(lexical__WEBPACK_IMPORTED_MODULE_11__.if,$onEnter,lexical__WEBPACK_IMPORTED_MODULE_11__.Ac),editor.registerCommand(lexical__WEBPACK_IMPORTED_MODULE_11__.Q$,$onEscape,lexical__WEBPACK_IMPORTED_MODULE_11__.Ac));return()=>{isMounted=!1,unregister()}}),[clearSelection,editor,isSelected,nodeKey,$onDelete,$onEnter,$onEscape,setSelected]);const draggable=isSelected&&(0,lexical__WEBPACK_IMPORTED_MODULE_11__.RT)(selection),isFocused=isSelected;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Suspense,{fallback:null},react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{draggable},react__WEBPACK_IMPORTED_MODULE_0__.createElement("button",{onClick:()=>{showModal("Update Inline Image",(onClose=>react__WEBPACK_IMPORTED_MODULE_0__.createElement(UpdateInlineImageDialog,{activeEditor:editor,nodeKey,onClose})))},className:"image-edit-button",ref:buttonRef},"Edit"),react__WEBPACK_IMPORTED_MODULE_0__.createElement(LazyImage,{altText,className:isFocused?"focused "+((0,lexical__WEBPACK_IMPORTED_MODULE_11__.RT)(selection)?"draggable":""):null,height,imageRef,position,src,width})),showCaption&&react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"image-caption-container"},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_lexical_react_LexicalNestedComposer__WEBPACK_IMPORTED_MODULE_15__.s,{initialEditor:caption},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_lexical_react_LexicalAutoFocusPlugin__WEBPACK_IMPORTED_MODULE_16__.x,null),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_plugins_LinkPlugin__WEBPACK_IMPORTED_MODULE_2__.A,null),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_lexical_react_LexicalRichTextPlugin__WEBPACK_IMPORTED_MODULE_17__.$,{contentEditable:react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_ContentEditable__WEBPACK_IMPORTED_MODULE_4__.A,{className:"InlineImageNode__contentEditable"}),ErrorBoundary:_lexical_react_LexicalErrorBoundary__WEBPACK_IMPORTED_MODULE_18__.A,placeholder:react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Placeholder__WEBPACK_IMPORTED_MODULE_6__.A,{className:"InlineImageNode__placeholder"},"Enter a caption...")})))),modal)}try{UpdateInlineImageDialog.displayName="UpdateInlineImageDialog",UpdateInlineImageDialog.__docgenInfo={description:"",displayName:"UpdateInlineImageDialog",props:{activeEditor:{defaultValue:null,description:"",name:"activeEditor",required:!0,type:{name:"LexicalEditor"}},nodeKey:{defaultValue:null,description:"",name:"nodeKey",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/nodes/InlineImageComponent.tsx#UpdateInlineImageDialog"]={docgenInfo:UpdateInlineImageDialog.__docgenInfo,name:"UpdateInlineImageDialog",path:"src/nodes/InlineImageComponent.tsx#UpdateInlineImageDialog"})}catch(__react_docgen_typescript_loader_error){}try{InlineImageComponent.displayName="InlineImageComponent",InlineImageComponent.__docgenInfo={description:"",displayName:"InlineImageComponent",props:{altText:{defaultValue:null,description:"",name:"altText",required:!0,type:{name:"string"}},caption:{defaultValue:null,description:"",name:"caption",required:!0,type:{name:"LexicalEditor"}},height:{defaultValue:null,description:"",name:"height",required:!0,type:{name:'number | "inherit"'}},nodeKey:{defaultValue:null,description:"",name:"nodeKey",required:!0,type:{name:"string"}},position:{defaultValue:null,description:"",name:"position",required:!0,type:{name:"enum",value:[{value:"undefined"},{value:'"left"'},{value:'"right"'},{value:'"full"'}]}},showCaption:{defaultValue:null,description:"",name:"showCaption",required:!0,type:{name:"boolean"}},src:{defaultValue:null,description:"",name:"src",required:!0,type:{name:"string"}},width:{defaultValue:null,description:"",name:"width",required:!0,type:{name:'number | "inherit"'}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/nodes/InlineImageComponent.tsx#InlineImageComponent"]={docgenInfo:InlineImageComponent.__docgenInfo,name:"InlineImageComponent",path:"src/nodes/InlineImageComponent.tsx#InlineImageComponent"})}catch(__react_docgen_typescript_loader_error){}}}]);